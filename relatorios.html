<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mapas e Anexos â€“ RH 1Âº BBM</title>
  <link rel="stylesheet" href="css/estilo.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script src="js/dados.js"></script>
  <script src="js/calculos.js"></script>
  <style>
    .anexo-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 8px solid var(--azul-bombeiro);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .btn-pdf {
      background: #c41e3a;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-pdf:hover {
      background: #8b0000;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo-container">
      <img src="https://ciabm-1bbm.github.io/site/logo-cbmrs.png" alt="CBMRS" class="logo" onerror="this.style.display='none'">
      <img src="https://ciabm-1bbm.github.io/site/brasao-rs.png" alt="RS" class="logo" onerror="this.style.display='none'">
      <img src="https://ciabm-1bbm.github.io/site/brasao-1bbm.png" alt="1Âº BBM" class="logo" onerror="this.style.display='none'">
    </div>
    <div class="titulo-sistema">ğŸš’ SISTEMA RH â€“ 1Âº BBM</div>
    <div><button class="btn btn-primary" onclick="window.location.href='index.html'">ğŸ  Dashboard</button></div>
  </div>

  <h2 style="color: var(--azul-marinho); margin: 20px 0;">ğŸ“„ MAPAS E ANEXOS OFICIAIS â€“ IR 003</h2>

  <!-- ANEXO A â€“ Mapa de Pagamento de GSE -->
  <div class="anexo-card" id="anexo-a">
    <h3>ğŸ“‹ ANEXO A â€“ Mapa de Pagamento de GratificaÃ§Ã£o por ServiÃ§o ExtraordinÃ¡rio</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoA()">ğŸ“„ GERAR PDF â€“ ANEXO A</button>
  </div>

  <!-- ANEXO B â€“ Mapa de Escala de ServiÃ§o Executada -->
  <div class="anexo-card" id="anexo-b">
    <h3>ğŸ“… ANEXO B â€“ Mapa de Escala de ServiÃ§o Executada</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoB()">ğŸ“„ GERAR PDF â€“ ANEXO B</button>
  </div>

  <!-- ANEXO C â€“ Extrato Demonstrativo de Carga HorÃ¡ria -->
  <div class="anexo-card" id="anexo-c">
    <h3>ğŸ“Š ANEXO C â€“ Extrato Demonstrativo de Carga HorÃ¡ria</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoC()">ğŸ“„ GERAR PDF â€“ ANEXO C</button>
  </div>

  <!-- ANEXO E â€“ Fluxograma de Processamento (Modelo) -->
  <div class="anexo-card" id="anexo-e">
    <h3>ğŸ”„ ANEXO E â€“ Fluxograma de Processamento da GSE</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoE()">ğŸ“„ GERAR PDF â€“ ANEXO E</button>
  </div>

  <!-- ANEXO F â€“ FormulÃ¡rio de Cadastro de Credor (AFE) -->
  <div class="anexo-card" id="anexo-f">
    <h3>ğŸ“ ANEXO F â€“ FormulÃ¡rio para InclusÃ£o/AlteraÃ§Ã£o de Cadastro de Credor</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoF()">ğŸ“„ GERAR PDF â€“ ANEXO F</button>
  </div>

  <!-- ANEXO G â€“ Mapa de Saque de Etapas de AlimentaÃ§Ã£o -->
  <div class="anexo-card" id="anexo-g">
    <h3>ğŸ½ï¸ ANEXO G â€“ Mapa de Saque de Etapas de AlimentaÃ§Ã£o</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoG()">ğŸ“„ GERAR PDF â€“ ANEXO G</button>
  </div>

  <!-- ANEXO I â€“ Justificativas para ExtensÃ£o da Jornada -->
  <div class="anexo-card" id="anexo-i">
    <h3>ğŸ“Œ ANEXO I â€“ Justificativas para ExtensÃ£o da Jornada Normal de Trabalho</h3>
    <button class="btn-pdf" onclick="gerarPDF_AnexoI()">ğŸ“„ GERAR PDF â€“ ANEXO I</button>
  </div>

  <script>
    // ========== ANEXO A ==========
    function gerarPDF_AnexoA() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(16);
      doc.text('ESTADO DO RIO GRANDE DO SUL', 105, 15, { align: 'center' });
      doc.setFontSize(14);
      doc.text('SECRETARIA DA SEGURANÃ‡A PÃšBLICA', 105, 22, { align: 'center' });
      doc.text('CORPO DE BOMBEIROS MILITAR â€“ 1Âº BBM', 105, 29, { align: 'center' });
      
      doc.setFontSize(12);
      doc.text('ANEXO â€œAâ€ â€“ MAPA DE PAGAMENTO DE GRATIFICAÃ‡ÃƒO POR SERVIÃ‡O EXTRAORDINÃRIO', 105, 40, { align: 'center' });
      doc.text('REFERENTE AO MÃŠS DE: JANEIRO/2026', 105, 47, { align: 'center' });
      
      doc.setFont('helvetica', 'normal');
      const resultado = JSON.parse(localStorage.getItem('resultado_he')) || { totalHE: 0, totalGSE: 0 };
      
      let y = 60;
      doc.text('1. Atesto a legalidade da despesa.', 20, y);
      y += 7;
      doc.text('2. Proceda-se o pagamento.', 20, y);
      y += 15;
      
      doc.text('Em: ____/____/______', 20, y);
      y += 10;
      doc.text('__________________________________________________', 20, y);
      y += 7;
      doc.text('[NOME DO COMANDANTE] â€“ TEN CEL QOEM', 20, y);
      y += 5;
      doc.text('Comandante do 1Âº BBM', 20, y);
      
      y += 20;
      doc.text(`Total de Horas Extras no mÃªs: ${resultado.totalHE}h`, 20, y);
      y += 7;
      doc.text(`Valor Total GSE: R$ ${resultado.totalGSE.toFixed(2)}`, 20, y);
      
      doc.save('ANEXO_A_GSE_JANEIRO_2026.pdf');
    }

    // ========== ANEXO B ==========
    function gerarPDF_AnexoB() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('landscape');
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œBâ€ â€“ MAPA DE ESCALA DE SERVIÃ‡O EXECUTADA', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('1Âº BatalhÃ£o de Bombeiro Militar â€“ JANEIRO/2026', 105, 25, { align: 'center' });
      
      const escalaDB = JSON.parse(localStorage.getItem('escala_1bbm')) || [];
      
      const headers = [['Data', 'ID Func', 'Nome', 'Posto', 'PelotÃ£o', 'FunÃ§Ã£o', 'Turno', 'Horas']];
      const data = escalaDB.map(e => [
        e.data, e.idFunc, e.nome, e.posto, e.pelotao || '', e.funcao, e.turno, `${e.horas}h`
      ]);
      
      doc.autoTable({
        head: headers,
        body: data,
        startY: 35,
        theme: 'grid',
        styles: { fontSize: 8, cellPadding: 2 },
        headStyles: { fillColor: [26, 44, 78] }
      });
      
      doc.save('ANEXO_B_ESCALA_JANEIRO_2026.pdf');
    }

    // ========== ANEXO C ==========
    function gerarPDF_AnexoC() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œCâ€ â€“ EXTRATO DEMONSTRATIVO DE CARGA HORÃRIA', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('1Âº BatalhÃ£o de Bombeiro Militar â€“ JANEIRO/2026', 105, 25, { align: 'center' });
      
      // Dados resumidos
      const resultado = JSON.parse(localStorage.getItem('resultado_he')) || { totalHE: 0, totalGSE: 0, totalEtapas: 0, totalValorEtapas: 0 };
      
      let y = 45;
      doc.setFont('helvetica', 'bold');
      doc.text('RESUMO DO MÃŠS:', 20, y);
      doc.setFont('helvetica', 'normal');
      y += 10;
      doc.text(`Carga horÃ¡ria obrigatÃ³ria (31 dias): 177h`, 20, y);
      y += 7;
      doc.text(`Total de horas trabalhadas: ${resultado.totalHE + 177}h`, 20, y);
      y += 7;
      doc.text(`Horas extras: ${resultado.totalHE}h`, 20, y);
      y += 7;
      doc.text(`Valor da GSE: R$ ${resultado.totalGSE.toFixed(2)}`, 20, y);
      y += 7;
      doc.text(`Total de etapas de alimentaÃ§Ã£o: ${resultado.totalEtapas}`, 20, y);
      y += 7;
      doc.text(`Valor das etapas: R$ ${resultado.totalValorEtapas.toFixed(2)}`, 20, y);
      
      doc.save('ANEXO_C_EXTRATO_JANEIRO_2026.pdf');
    }

    // ========== ANEXO E ==========
    function gerarPDF_AnexoE() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œEâ€ â€“ FLUXOGRAMA DE PROCESSAMENTO DA GSE', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      
      let y = 40;
      doc.setFont('helvetica', 'bold');
      doc.text('FLUXOGRAMA DE PROCESSAMENTO DA GRATIFICAÃ‡ÃƒO POR SERVIÃ‡O EXTRAORDINÃRIO NO CBMRS', 20, y);
      y += 15;
      
      doc.setFont('helvetica', 'normal');
      const etapas = [
        '1. O Comando da CorporaÃ§Ã£o solicita autorizaÃ§Ã£o para execuÃ§Ã£o de serviÃ§o extraordinÃ¡rio em cotas mensais.',
        '2. O Subcomandante-Geral define a cota-referÃªncia de cada BatalhÃ£o.',
        '3. O Departamento Administrativo distribui as cotas aos BatalhÃµes.',
        '4. O Comando do OBM atesta a legalidade da despesa e lanÃ§a no sistema RHE.',
        '5. O DA executa a rotina no sistema RHE para migraÃ§Ã£o das informaÃ§Ãµes para a folha.',
        '6. Em caso de impossibilidade de lanÃ§amento, processo via PROA Ã© encaminhado ao DA.',
        '7. Identificado lanÃ§amento indevido, o Comandante solicita estorno via PROA.'
      ];
      
      etapas.forEach(etapa => {
        doc.text(etapa, 25, y);
        y += 8;
      });
      
      doc.save('ANEXO_E_FLUXOGRAMA_GSE.pdf');
    }

    // ========== ANEXO F ==========
    function gerarPDF_AnexoF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œFâ€ â€“ FORMULÃRIO DE CADASTRO DE CREDOR (AFE)', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('ESTADO DO RIO GRANDE DO SUL â€“ SECRETARIA DA FAZENDA', 105, 25, { align: 'center' });
      doc.text('SECCIONAL DA CAGE â€“ BM', 105, 32, { align: 'center' });
      
      let y = 50;
      doc.setFont('helvetica', 'bold');
      doc.text('Nome: ____________________________________________________', 20, y);
      y += 10;
      doc.text('CPF/CNPJ: ___________________________ CÃ³digo de Pessoa: ______________', 20, y);
      y += 10;
      doc.text('Telefone: ___________________________', 20, y);
      y += 20;
      
      doc.setFont('helvetica', 'normal');
      doc.text('Solicito Ã  Seccional da CAGE junto Ã  Brigada Militar do RS a inclusÃ£o ou alteraÃ§Ã£o de meu', 20, y);
      y += 7;
      doc.text('cadastro no AFE/FPE, declarando serem verdadeiras as informaÃ§Ãµes abaixo. Anexo cÃ³pias', 20, y);
      y += 7;
      doc.text('legÃ­veis dos seguintes documentos, declarando que sÃ£o fiÃ©is aos originais:', 20, y);
      y += 15;
      
      doc.text('( ) CÃ³pia identidade funcional ou civil', 25, y);
      y += 7;
      doc.text('( ) CÃ³pia CPF/CNPJ', 25, y);
      y += 7;
      doc.text('( ) Comprovante de residÃªncia', 25, y);
      y += 7;
      doc.text('( ) Extrato bancÃ¡rio/folha de cheque/contracheque com conta atualizada', 25, y);
      
      y += 20;
      doc.text('Assinatura do servidor solicitante: ______________________________', 20, y);
      
      doc.save('ANEXO_F_CADASTRO_CREDOR.pdf');
    }

    // ========== ANEXO G ==========
    function gerarPDF_AnexoG() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œGâ€ â€“ MAPA DE SAQUE DE ETAPAS DE ALIMENTAÃ‡ÃƒO', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('1Âº BatalhÃ£o de Bombeiro Militar â€“ JANEIRO/2026', 105, 25, { align: 'center' });
      
      const resultado = JSON.parse(localStorage.getItem('resultado_he')) || { totalEtapas: 0, totalValorEtapas: 0 };
      
      let y = 45;
      doc.text('1. Atesto a legalidade da despesa.', 20, y);
      y += 7;
      doc.text('2. Proceda-se o pagamento.', 20, y);
      y += 10;
      doc.text('Em: ____/____/______', 20, y);
      y += 15;
      
      doc.setFont('helvetica', 'bold');
      doc.text('MAPA DE SAQUE DE ETAPAS DE ALIMENTAÃ‡ÃƒO', 20, y);
      y += 10;
      doc.setFont('helvetica', 'normal');
      
      doc.text(`Total de etapas no mÃªs: ${resultado.totalEtapas}`, 20, y);
      y += 7;
      doc.text(`Valor total: R$ ${resultado.totalValorEtapas.toFixed(2)}`, 20, y);
      y += 7;
      doc.text(`(Valor unitÃ¡rio: R$ 12,79)`, 20, y);
      
      y += 15;
      doc.text('Certifico que as etapas de alimentaÃ§Ã£o inseridas se adequam Ã s hipÃ³teses do art. 63 da Lei nÂº 6.196/71.', 20, y);
      
      doc.save('ANEXO_G_ETAPAS_JANEIRO_2026.pdf');
    }

    // ========== ANEXO I ==========
    function gerarPDF_AnexoI() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      doc.setFontSize(16);
      doc.text('ANEXO â€œIâ€ â€“ JUSTIFICATIVAS PARA EXTENSÃƒO DA JORNADA', 105, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('1Âº BatalhÃ£o de Bombeiro Militar â€“ JANEIRO/2026', 105, 25, { align: 'center' });
      
      let y = 45;
      doc.setFont('helvetica', 'bold');
      doc.text('JUSTIFICATIVAS PARA SERVIÃ‡O EXTRAORDINÃRIO:', 20, y);
      y += 10;
      doc.setFont('helvetica', 'normal');
      
      const justificativas = [
        'a) Atender a situaÃ§Ãµes excepcionais e temporÃ¡rias (caput, art. 2Âº, Decreto 40.986/01);',
        'b) Imperiosa necessidade de serviÃ§o ligada Ã  atividade fim do CBMRS;',
        'c) Manter a normalidade dos serviÃ§os (Â§4Âº, art. 2Âº);',
        'd) Dar curso a ocorrÃªncias jÃ¡ iniciadas;',
        'e) Fazer frente a situaÃ§Ãµes imprevistas que atentem contra a vida e/ou a seguranÃ§a pÃºblica.'
      ];
      
      justificativas.forEach(j => {
        doc.text(j, 25, y);
        y += 7;
      });
      
      y += 15;
      doc.setFont('helvetica', 'bold');
      doc.text('VEDAÃ‡Ã•ES (Decreto nÂº 40.986/01):', 20, y);
      y += 10;
      doc.setFont('helvetica', 'normal');
      
      const vedacoes = [
        '- Quando nÃ£o houver justificativa sobre a imprescindibilidade da extensÃ£o;',
        '- Aos servidores que estiverem percebendo diÃ¡rias de viagem;',
        '- Detentores de funÃ§Ã£o gratificada ou cargo em comissÃ£o (exceto oficiais intermediÃ¡rios, subalternos e praÃ§as em funÃ§Ã£o de comando);',
        '- Para desenvolvimento de atividades administrativas do CBMRS;',
        '- Sem prÃ©via autorizaÃ§Ã£o.'
      ];
      
      vedacoes.forEach(v => {
        doc.text(v, 25, y);
        y += 6;
      });
      
      doc.save('ANEXO_I_JUSTIFICATIVAS_JANEIRO_2026.pdf');
    }
  </script>
</body>
</html>