<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro â€“ RH 1Âº BBM</title>
  <link rel="stylesheet" href="css/estilo.css">
  <style>
    .filtros {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .filtro-item {
      flex: 1;
      min-width: 200px;
    }
    .badge {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    .badge-cov { background: #c8e6c9; color: #1e3a1e; }
    .badge-adm { background: #fff3e0; color: #b76e1e; }
    .badge-ativo { background: #c8e6c9; color: #1e3a1e; }
    .badge-ferias { background: #ffcdd2; color: #b71c1c; }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo-container">
      <img src="https://ciabm-1bbm.github.io/site/logo-cbmrs.png" alt="CBMRS" class="logo" onerror="this.style.display='none'">
      <img src="https://ciabm-1bbm.github.io/site/brasao-rs.png" alt="RS" class="logo" onerror="this.style.display='none'">
      <img src="https://ciabm-1bbm.github.io/site/brasao-1bbm.png" alt="1Âº BBM" class="logo" onerror="this.style.display='none'">
    </div>
    <div class="titulo-sistema">
      ğŸš’ SISTEMA RH â€“ 1Âº BBM
    </div>
    <div>
      <button class="btn btn-primary" onclick="window.location.href='index.html'">ğŸ  Dashboard</button>
    </div>
  </div>

  <div style="margin: 20px 0; display: flex; justify-content: space-between; align-items: center;">
    <h2 style="color: var(--azul-marinho);">ğŸ‘¥ GESTÃƒO DE EFETIVO</h2>
    <span style="background: var(--azul-bombeiro); color: white; padding: 8px 16px; border-radius: 20px;" id="total-militares">Carregando...</span>
  </div>

  <!-- Filtros -->
  <div class="filtros">
    <div class="filtro-item">
      <label for="filtro-nome">Buscar por Nome ou ID</label>
      <input type="text" id="filtro-nome" placeholder="Digite nome ou ID funcional" onkeyup="filtrarTabela()">
    </div>
    <div class="filtro-item">
      <label for="filtro-pelotao">PelotÃ£o</label>
      <select id="filtro-pelotao" onchange="filtrarTabela()">
        <option value="todos">Todos</option>
        <option value="1Âº Pel">1Âº Pel</option>
        <option value="2Âº Pel">2Âº Pel</option>
        <option value="3Âº Pel">3Âº Pel</option>
        <option value="4Âº Pel">4Âº Pel</option>
        <option value="5Âº Pel">5Âº Pel</option>
        <option value="6Âº Pel">6Âº Pel</option>
        <option value="7Âº Pel">7Âº Pel</option>
        <option value="8Âº Pel">8Âº Pel</option>
      </select>
    </div>
    <div class="filtro-item">
      <label for="filtro-situacao">SituaÃ§Ã£o</label>
      <select id="filtro-situacao" onchange="filtrarTabela()">
        <option value="todos">Todos</option>
        <option value="Ativo">Ativo</option>
        <option value="FÃ©rias">FÃ©rias</option>
        <option value="Op VerÃ£o">Op VerÃ£o</option>
        <option value="LTS">LTS</option>
      </select>
    </div>
  </div>

  <!-- Tabela de Efetivo -->
  <div class="tabela-container">
    <table id="tabela-efetivo">
      <thead>
        <tr>
          <th>ID Func</th>
          <th>Nome (Guerra)</th>
          <th>Posto</th>
          <th>PelotÃ£o</th>
          <th>FunÃ§Ã£o</th>
          <th>COV?</th>
          <th>AEM?</th>
          <th>ADM?</th>
          <th>Valor HE</th>
          <th>SituaÃ§Ã£o</th>
        </tr>
      </thead>
      <tbody id="corpo-tabela">
        <!-- Preenchido via JS -->
      </tbody>
    </table>
  </div>

  <!-- BotÃ£o para adicionar (simula) -->
  <div style="margin-top: 30px; text-align: right;">
    <button class="btn btn-success" onclick="alert('Para adicionar militares, edite o arquivo js/dados.js diretamente.')">
      â• Adicionar Militar
    </button>
    <button class="btn btn-primary" onclick="window.location.href='index.html'" style="margin-left: 15px;">
      ğŸ”™ Voltar ao Painel
    </button>
  </div>

  <div class="rodape">
    <p>ğŸ“‹ InstruÃ§Ã£o Reguladora nÂº 003/Adm/Exc-20 â€“ Corpo de Bombeiros Militar do RS</p>
    <p>Â© 2026 1Âº BBM â€“ Sistema desenvolvido pela SeÃ§Ã£o de RH</p>
  </div>

  <script src="js/dados.js"></script>
  <script>
    let militaresFiltrados = [];

    function carregarTabela() {
      const tbody = document.getElementById('corpo-tabela');
      const totalSpan = document.getElementById('total-militares');
      
      // Usa a variÃ¡vel global 'efetivo' do dados.js
      let dados = efetivo;
      militaresFiltrados = dados;
      
      totalSpan.innerText = `Total: ${dados.length} militares`;
      
      let html = '';
      dados.forEach(m => {
        html += `<tr>
          <td><strong>${m.idFunc}</strong></td>
          <td>${m.nomeCompleto} (${m.nomeGuerra})</td>
          <td>${m.posto}</td>
          <td>${m.pelotao}</td>
          <td>${m.funcaoPadrao}</td>
          <td>${m.isCOV ? 'âœ…' : 'âŒ'}</td>
          <td>${m.isAEM ? 'âœ…' : 'âŒ'}</td>
          <td>${m.isADM ? 'âœ…' : 'âŒ'}</td>
          <td>R$ ${m.valorHoraExtra.toFixed(2)}</td>
          <td><span class="badge ${m.situacao === 'Ativo' ? 'badge-ativo' : 'badge-ferias'}">${m.situacao}</span></td>
        </tr>`;
      });
      tbody.innerHTML = html;
    }

    function filtrarTabela() {
      const nomeFiltro = document.getElementById('filtro-nome').value.toLowerCase();
      const pelotaoFiltro = document.getElementById('filtro-pelotao').value;
      const situacaoFiltro = document.getElementById('filtro-situacao').value;
      
      const dados = efetivo.filter(m => {
        const matchNome = m.nomeCompleto.toLowerCase().includes(nomeFiltro) || 
                          m.nomeGuerra.toLowerCase().includes(nomeFiltro) || 
                          m.idFunc.includes(nomeFiltro);
        const matchPelotao = pelotaoFiltro === 'todos' || m.pelotao === pelotaoFiltro;
        const matchSituacao = situacaoFiltro === 'todos' || m.situacao === situacaoFiltro;
        return matchNome && matchPelotao && matchSituacao;
      });
      
      militaresFiltrados = dados;
      document.getElementById('total-militares').innerText = `Total: ${dados.length} militares`;
      
      let html = '';
      dados.forEach(m => {
        html += `<tr>
          <td><strong>${m.idFunc}</strong></td>
          <td>${m.nomeCompleto} (${m.nomeGuerra})</td>
          <td>${m.posto}</td>
          <td>${m.pelotao}</td>
          <td>${m.funcaoPadrao}</td>
          <td>${m.isCOV ? 'âœ…' : 'âŒ'}</td>
          <td>${m.isAEM ? 'âœ…' : 'âŒ'}</td>
          <td>${m.isADM ? 'âœ…' : 'âŒ'}</td>
          <td>R$ ${m.valorHoraExtra.toFixed(2)}</td>
          <td><span class="badge ${m.situacao === 'Ativo' ? 'badge-ativo' : 'badge-ferias'}">${m.situacao}</span></td>
        </tr>`;
      });
      document.getElementById('corpo-tabela').innerHTML = html;
    }

    window.onload = carregarTabela;
  </script>
</body>
</html>
